"""
{DOMAIN} 도메인 - 목록 API
"""

from typing import List

from fastapi import APIRouter, Depends, Query
from sqlmodel import select
from sqlmodel.ext.asyncio.session import AsyncSession

from src.core.database import get_session
from src.core.response import ApiResponse, Status
from ..entities import {DOMAIN_TITLE}Response
from ..models import {DOMAIN_TITLE}

router = APIRouter()


@router.get(
    "/{DOMAIN}",
    response_model=ApiResponse[List[{DOMAIN_TITLE}Response]],
)
async def list_{DOMAIN}(
    skip: int = Query(0, ge=0),
    limit: int = Query(10, ge=1, le=100),
    session: AsyncSession = Depends(get_session),
) -> ApiResponse[List[{DOMAIN_TITLE}Response]]:
    """
    {DOMAIN} 목록 조회
    
    SPEC.md 기반 페이지네이션
    """
    
    stmt = (
        select({DOMAIN_TITLE})
        .offset(skip)
        .limit(limit)
    )
    
    result = await session.exec(stmt)
    items = result.all()
    
    return ApiResponse(
        status=Status.SUCCESS,
        message="{SUCCESS_MESSAGE}",  # SPEC에서 추출
        data=[
            {DOMAIN_TITLE}Response.model_validate(item)
            for item in items
        ],
    )


# Template 사용법:
# 1. {DOMAIN} → 도메인명
# 2. {DOMAIN_TITLE} → 타이틀 케이스
# 3. {SUCCESS_MESSAGE} → SPEC의 성공 메시지
